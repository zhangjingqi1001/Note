# 分层解耦  



# 一、 分层解耦



* 内聚： 软件中各个功能模块内部的功能联系
* 耦合： 衡量软件中各个层/模块之间的依赖、关联的程度
* 软件设计原则：高内聚、低耦合



​     **控制反转**：Inversion Of Control,简称IOC。对象的创建控制权由程序自身转移到外部（容器），这种思想成为控制反转

​     **依赖注入**：Dependency Injection，简称DI。容器为应用程序提供运行时，所依赖的资源，称为依赖注入。

​     **Bean对象**： IOC容器中创建、管理的对象，称为bean

 



## 1.1 IOC - 控制反转 详细

把某个对象交给IOC容器管理，需要添加如下注解之一：

|    注解     |        说明        |                      位置                       |
| :---------: | :----------------: | :---------------------------------------------: |
| @Component  | 生命bean的基础注解 |           不属于以下三类时，用此注解            |
| @Controller | @Component衍生注解 |                  标注在控制器                   |
|  @Service   | @Component衍生注解 |                 标注在业务类上                  |
| @Repository | @Component衍生注解 | 标注在数据访问类上（由于与Mybatis整合，用的少） |



* 声名bean的时候，可以通过value属性指定bean的名字，如果没有指定，默认是类名首字母小写

  

*  使用以上四个注解都可以生命bean，但是在Springboot集成web开发中，声名控制器bean只能用@Controller 



* bean的四大注解想要生效，**需要被组件扫描注解@ComponentScan扫描**

  

*  @ComponentScan注解虽然没有显示配置，但是实际上已经包含在了启动类生命注解@SpringBootApplication中，默认扫描的范围是启动类所在包及其子包

    如下包名是从“java”包后开始的，但是下面这种不推荐，我们希望的是按照Spring的规范，将包设置在启动类所在包及其子包

```java
@ComponentScan({"dao","com.zhangjingqi"})
```





## 1.2 DI - 依赖注入 详解

 

**@Autowired 注解**，**默认是按照类型进行**的，如果存在多个相同的bean，会报错。



 EmpServiceA 实现 EmpService类，EmpServiceB 实现 EmpService类，我们在某个地方注入EmpService对象时便会出现注入错误。



**解决方案**

* **@Primary  设置bean的优先级**

​        如果我们想要哪个bean填入容器，可以在类名之上添加@Primary



*  **@Qualifier**  指定bean的名字

```java
   @Qualifier("empServiceA")
   @Autowired
   private EmpService empService;
```



* **@Resource** 按照名称注入

   **@Autowired 注解默认按照类型注入，@Resource默认按照类名进行注入**

```java
   @Resource(name = "empServiceB")
   private EmpService empService;
```

 