# XML转JSON时数组属性转换成Java对象属性的解决方案



# XML转JSON

使用的Hutool工具类将XML数据转换成了java数据

* **情况1**

```java
public String getJSONStringObject() {
    return JSONUtil.parseFromXml("<Response>\n" +
                "    <TransCode>62001</TransCode>\n" +
                "    <ResultCode>0</ResultCode>\n" +
                "    <ErrorMsg></ErrorMsg>\n" +
                "    <Items>\n" +
                "        <Item>\n" +
                "            <ApplyNo>844395</ApplyNo>\n" +
                "            <RepName>载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯</RepName>\n" +
                "            <RepCateID>021</RepCateID>\n" +
                "            <RepCateName>载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯</RepCateName>\n" +
                "            <Status>2</Status>\n" +
                "            <SendTime></SendTime>\n" +
                "            <RepTime>2023-11-16 11:44:36</RepTime>\n" +
                "            <ReportFlag>1</ReportFlag>\n" +
                "            <RemarkFlag>0</RemarkFlag>\n" +
                "        </Item>\n" +
                "    </Items>\n" +
                "</Response>").toString();
}
```

上面方法的返回值是下面所示，显然不是我们需要的，我们想要一个数组的形式，下面都是一个对象的形式

"Item"节点是对象的形式

```java
{
    "Response":{
        "ErrorMsg":"",
        "TransCode":62001,
        "Items":{
            "Item":{
                "Status":2,
                "RepTime":"2023-11-16 11:44:36",
                "SendTime":"",
                "ReportFlag":1,
                "RepCateName":"载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯",
                "RepName":"载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯",
                "RepCateID":"021",
                "RemarkFlag":0,
                "ApplyNo":844395
            }
        },
        "ResultCode":0
    }
}
```

* **情况2**

```java
public String getJSONStringJSON() {
    return JSONUtil.parseFromXml("<Response>\n" +
                "    <TransCode>62001</TransCode>\n" +
                "    <ResultCode>0</ResultCode>\n" +
                "    <ErrorMsg></ErrorMsg>\n" +
                "    <Items>\n" +
                "        <Item>\n" +
                "            <ApplyNo>844395</ApplyNo>\n" +
                "            <RepName>载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯</RepName>\n" +
                "            <RepCateID>021</RepCateID>\n" +
                "            <RepCateName>载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯</RepCateName>\n" +
                "            <Status>2</Status>\n" +
                "            <SendTime></SendTime>\n" +
                "            <RepTime>2023-11-16 11:44:36</RepTime>\n" +
                "            <ReportFlag>1</ReportFlag>\n" +
                "            <RemarkFlag>0</RemarkFlag>\n" +
                "        </Item>\n" +
                "        <Item>\n" +
                "            <ApplyNo>844395</ApplyNo>\n" +
                "            <RepName>载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯</RepName>\n" +
                "            <RepCateID>021</RepCateID>\n" +
                "            <RepCateName>载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯</RepCateName>\n" +
                "            <Status>2</Status>\n" +
                "            <SendTime></SendTime>\n" +
                "            <RepTime>2023-11-16 11:44:36</RepTime>\n" +
                "            <ReportFlag>1</ReportFlag>\n" +
                "            <RemarkFlag>0</RemarkFlag>\n" +
                "        </Item>\n" +
                "    </Items>\n" +
                "</Response>").toString();
}
```

"Item"节点是数组的形式

```json
{
    "Response":{
        "ErrorMsg":"",
        "TransCode":62001,
        "Items":{
            "Item":[
                {
                    "Status":2,
                    "RepTime":"2023-11-16 11:44:36",
                    "SendTime":"",
                    "ReportFlag":1,
                    "RepCateName":"载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯",
                    "RepName":"载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯",
                    "RepCateID":"021",
                    "RemarkFlag":0,
                    "ApplyNo":844395
                },
                {
                    "Status":2,
                    "RepTime":"2023-11-16 11:44:36",
                    "SendTime":"",
                    "ReportFlag":1,
                    "RepCateName":"载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯",
                    "RepName":"载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯",
                    "RepCateID":"021",
                    "RemarkFlag":0,
                    "ApplyNo":844395
                }
            ]
        },
        "ResultCode":0
    }
}
```



# Hutool工具类的方式解决



```java
public class Test02Mian {
    public static void main(String[] args) {

        JSONObject responseJSON =  this.getJSONStringObject();

        System.out.println(responseJSON);
        //非异常情况下要走这个判断
        if (responseJSON.getJSONObject("Response").getStr("ResultCode").equals("0")) {
            JSONObject itemsObject = responseJSON.getJSONObject("Response").getJSONObject("Items");
            //避免空指针异常
            if (itemsObject != null) {
                Object item = itemsObject.get("Item");

                if (item instanceof JSONObject) {
                    //说明是对象，进行处理
                    //转换成数组
                    JSONArray jsonArray = new JSONArray();
                    jsonArray.put(item);
                
                    itemsObject.put("Item", jsonArray);
                }
            }
        }
        //最终处理结果
        System.out.println(responseJSON);
    }
}
```

**返回值**

"Item"确实成数组了

```json
{
    "Response":{
        "ErrorMsg":"",
        "TransCode":62001,
        "Items":{
            "Item":[
                {
                    "Status":2,
                    "RepTime":"2023-11-16 11:44:36",
                    "SendTime":"",
                    "ReportFlag":1,
                    "RepCateName":"载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯",
                    "RepName":"载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯",
                    "RepCateID":"021",
                    "RemarkFlag":0,
                    "ApplyNo":844395
                }
            ]
        },
        "ResultCode":0
    }
}
```





# **FastJSON处理方式**

```java
    public static void main(String[] args) {
        TestController testController = new TestController();

        String jsonStringJSON = testController.getJSONStringObject();

        JSONObject jsonJSON = JSONObject.parseObject(jsonStringJSON);

        if (jsonJSON.getJSONObject("Response").getString("ResultCode").equals("0")) {
            JSONObject itemsObject = jsonJSON.getJSONObject("Response").getJSONObject("Items");
            if (itemsObject != null) {
                Object item = itemsObject.get("Item");

                if (item instanceof JSONObject) {
                    //说明是对象，进行处理
                    JSONArray jsonArray = new JSONArray();
                    jsonArray.add(item);

                    itemsObject.put("Item", jsonArray);
                }
            }
        }
        System.out.println(jsonJSON);
    }
```

最终的输出结果

```json
{
    "Response":{
        "TransCode":62001,
        "ErrorMsg":"",
        "Items":{
            "Item":[
                {
                    "Status":2,
                    "RepTime":"2023-11-16 11:44:36",
                    "SendTime":"",
                    "ReportFlag":1,
                    "RepCateID":"021",
                    "RepCateName":"载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯",
                    "RemarkFlag":0,
                    "ApplyNo":844395,
                    "RepName":"载脂蛋白B,低密度脂蛋白胆固醇,高密度脂蛋白胆固醇,载脂蛋白A1,★总胆固醇,★甘油三酯"
                }
            ]
        },
        "ResultCode":0
    }
}
```

